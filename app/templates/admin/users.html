{% extends "base.html" %}
{% block content %}
<section class="page">
  <div class="admin-head">
    <div>
      <h1 style="margin:0;">Users</h1>
      <p class="muted" style="margin:6px 0 0;">Search and edit users. Assign class per student here.</p>
    </div>

    <form method="get" class="admin-search">
      <input class="input" type="text" name="q" value="{{ q or '' }}" placeholder="Search name, email, phone">
      <button class="btn" type="submit">Search</button>
      {% if q %}<a class="btn secondary" href="{{ url_for('admin.users') }}">Clear</a>{% endif %}
    </form>
  </div>


  {# Admin navigation (keep your existing links if you have them) #}
  <div class="card admin-nav" style="margin-top:14px;">
    <a href="{{ url_for('admin.messages') }}">Messages</a>
    <a href="{{ url_for('admin.teachers') }}" >Teachers</a>
    <a href="{{ url_for('admin.venues') }}">Venues</a>
    <a href="{{ url_for('admin.syllabus') }}">Syllabus</a>
    <a href="{{ url_for('admin.bookings') }}">Bookings</a>
    <a href="{{ url_for('admin.users') }}" class="active">Users</a>
  </div>


  <div class="card">
    {% if not items %}
      <p class="muted" style="margin:0;">No users found.</p>
    {% else %}
      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>User</th>
              <th>Email</th>
              <th>Role</th>
              <th>Assigned Class</th>
              <th>Phone</th>
              <th style="width:120px;">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for u in items %}
              <tr>
                <td style="font-weight:900;">{{ u.name }}</td>
                <td>{{ u.email }}</td>
                <td><span class="pill">{{ u.role }}</span></td>
                <td>{{ u.class_label }}</td>
                <td>{{ u.phone }}</td>
                <td>
                  <a class="btn small" href="{{ url_for('admin.user_edit', user_id=u.id) }}">Edit</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>
</section>

<style>
  .admin-head{ display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; align-items:flex-end; }
  .admin-search{ display:flex; gap:8px; flex-wrap:wrap; }
  .table-wrap{ overflow:auto; }
  .table{ width:100%; border-collapse: collapse; }
  .table th, .table td{ padding:10px 12px; border-bottom:1px solid var(--border,#e6e6ee); }
  .pill{ padding:3px 10px; border-radius:999px; border:1px solid var(--border,#e6e6ee); font-weight:950; font-size:12px; }
  .btn.small{ padding:6px 10px; font-size:13px; }
  @media (max-width: 520px){
    .admin-search .input{ width:100%; }
  }
</style>
{% endblock %}
